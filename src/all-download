#!/bin/bash
set -e

# Fair Oaks Recreation and Park District
npx tsx src/forpd.ts docs/FORPD

# Sacramento Municipal Utility District
npx tsx src/smud.ts docs/SMUD

# San Juan Unified School District
npx tsx src/sjusd.ts docs/SJUSD

# Sacramento Metropolitan Fire District
npx tsx src/smfd.ts docs/SMFD

# Fair Oaks Water District
npx tsx src/fowd.ts docs/FOWD

# Sacramento Board of Education
npx tsx src/scoe.ts docs/SCOE

# Los Rios Community College District
npx tsx src/lrccd.ts docs/LRCCD

# San Juan Water District
npx tsx src/sjwd.ts docs/SJWD


# List all SCOE meeting minutes files
find docs/SCOE -type f -name "[0-9][0-9].[0-9][0-9].[0-9][0-9] Board Minutes*" | sort

# Find all board minutes files and move them to matching date folders
find docs/SCOE -type f -name "[0-9][0-9].[0-9][0-9].[0-9][0-9] Board Minutes*" | while read file; do
  # Extract MM.DD.YY from filename
  filename=$(basename "$file")
  if [[ $filename =~ ([0-9]{2})\.([0-9]{2})\.([0-9]{2}) ]]; then
    month=${filename:0:2}
    day=${filename:3:2}
    year=${filename:6:2}


    # Convert to 20YY-MM-DD format for directory matching
    target_date="20${year}-${month}-${day}"

    # Find matching directory
    target_dir=$(find docs/SCOE -type d -name "${target_date}-*" | head -n 1)

    if [ -n "$target_dir" ]; then
      mv "$file" "$target_dir/"
      echo "Moved $filename to $target_dir"
    else
      echo "No matching directory found for $filename"
    fi
  fi
done

